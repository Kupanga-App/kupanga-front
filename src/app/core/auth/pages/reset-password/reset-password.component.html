<p-toast position="top-right"></p-toast>
<div class="reset-password-page">
  <div class="reset-password-card">

    <!-- Header -->
    <header class="reset-password-card__header">
      <h1 class="reset-password-card__title">Nouveau mot de passe</h1>
      <p class="reset-password-card__subtitle">Veuillez saisir votre nouveau mot de passe ci-dessous.</p>
    </header>

    <!-- Reset Form -->
    <form [formGroup]="resetForm" (ngSubmit)="onResetPassword()">

      <div class="form-group">
        <label for="password" class="form-group__label">Mot de passe</label>
        <p-password id="password" formControlName="password" [toggleMask]="true" [feedback]="true"
          styleClass="p-password-full" placeholder="Nouveau mot de passe">
          <ng-template pTemplate="header">
            <h6>Choisissez un mot de passe</h6>
          </ng-template>
          <ng-template pTemplate="footer">
            <p class="mt-2">Suggestions</p>
            <ul class="pl-2 ml-2 mt-0" style="line-height: 1.5">
              <li>Au moins une minuscule</li>
              <li>Au moins une majuscule</li>
              <li>Au moins un chiffre</li>
              <li>Minimum 8 caractères</li>
            </ul>
          </ng-template>
        </p-password>
        <small *ngIf="resetForm.get('password')?.invalid && resetForm.get('password')?.touched"
          class="form-group__error">
          Mot de passe requis (min 8 caractères).
        </small>
      </div>

      <div class="form-group form-group--last">
        <label for="confirmPassword" class="form-group__label">Confirmer le mot de passe</label>
        <p-password id="confirmPassword" formControlName="confirmPassword" [toggleMask]="true" [feedback]="false"
          styleClass="p-password-full" placeholder="Confirmez votre mot de passe"></p-password>
        <small
          *ngIf="resetForm.get('confirmPassword')?.hasError('passwordMismatch') && resetForm.get('confirmPassword')?.touched"
          class="form-group__error">
          Les mots de passe ne correspondent pas.
        </small>
      </div>

      <p-button label="Réinitialiser le mot de passe" type="submit" [loading]="isLoading" styleClass="p-button-full"
        [disabled]="resetForm.invalid || !token"></p-button>

      <footer class="reset-password-card__footer">
        <a routerLink="/auth/login" class="footer__link">Retour à la connexion</a>
      </footer>
    </form>

  </div>
</div>
